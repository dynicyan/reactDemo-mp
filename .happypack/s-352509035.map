{"version":3,"sources":["src/app.state.js"],"names":["AppState","webpSupport","appVersion","userId","phoneNum","checkWebp","getQueryString","openid","setItem","serf","post","getItem","then","data","userData","setLocalUser","catch","error","console","log","phoneNumber","userType","vipUsersId","vipUsersName","headPortrait"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;IAGMA,Q;AACF,wBAAc;AAAA;AAAA,aAIdC,WAJc,GAIA,KAJA;AAAA,aAKdC,UALc,GAKD,OALC;;AACV,aAAKC,MAAL,GAAc,EAAd;AACA,aAAKC,QAAL,GAAgB,EAAhB;AACH;;;;;;;;;;;uCAI4B,eAAKC,SAAL,E;;;AAAzB,qCAAKJ,W;;;;;;;;;;;;;;;;;AAGT;;;;oCACY;AACR;AACA;AACA;AACA;AACA,gBAAG,eAAKK,cAAL,CAAoB,QAApB,KAAiC,IAApC,EAAyC;AACrC,oBAAMC,SAAS,eAAKD,cAAL,CAAoB,QAApB,CAAf;AACA;AACA,wCAAME,OAAN,CAAc,QAAd,EAAwBD,MAAxB;AACA,wCAAMC,OAAN,CAAc,QAAd,EAAwBD,MAAxB;;AAEA;AACH;AAEJ;;;sCAEa;AACV,gBAAIE,OAAO,IAAX;AACA,4BAAMC,IAAN,CAAW,oCAAX,EAAiD,EAACH,QAAQ,wBAAMI,OAAN,CAAc,QAAd,CAAT,EAAjD,EAAoFC,IAApF,CAAyF,UAAUC,IAAV,EAAgB;AACrG;AACA,oBAAMC,WAAWD,KAAKA,IAAL,CAAUA,IAA3B;AACA;AACA;;AAEAJ,qBAAKM,YAAL,CAAkBD,QAAlB;;AAEA;AACA;AACA;;AAEA;AACA;AACH,aAdD,EAcGE,KAdH,CAcS,UAACC,KAAD,EAAS;AACdC,wBAAQC,GAAR,CAAY,YAAUF,KAAtB;AACH,aAhBD;AAmBH;;AAED;;;;qCACaJ,I,EAAM;AACf,oCAAML,OAAN,CAAc,WAAd,EAA2BK,KAAKO,WAAhC,EADe,CAC8B;AAC7C,oCAAMZ,OAAN,CAAc,UAAd,EAA0BK,KAAKQ,QAA/B,EAFe,CAE0B;AACzC,oCAAMb,OAAN,CAAc,QAAd,EAAwBK,KAAKS,UAA7B,EAHe,CAG0B;AACzC,oCAAMd,OAAN,CAAc,aAAd,EAA6BK,KAAKU,YAAlC,EAJe,CAIiC;AAChD,oCAAMf,OAAN,CAAc,cAAd,EAA8BK,KAAKW,YAAnC,EALe,CAKkC;AACpD;;;;;kBAKU,IAAIxB,QAAJ,E","file":"app.state.js","sourceRoot":"/Users/yandong/Downloads/mpaireact","sourcesContent":["import Util from './helpers/util';\nimport local from './helpers/locallStorage';\nimport axios from './config/axios';\nimport { weChatConfig } from './config/wechatService';\n\n\nclass AppState {\n    constructor() {\n        this.userId = '';\n        this.phoneNum = ''\n    }\n    webpSupport = false\n    appVersion = '1.0.0'\n    async initConfig() {\n        this.webpSupport = await Util.checkWebp()\n    }\n\n    //设置openid\n    getOpenId() {\n        // if(local.getItem('openid') == null) {\n        //     return;\n        // }else {\n        // 判断url中有没有openId\n        if(Util.getQueryString('openid') != null){\n            const openid = Util.getQueryString('openid')\n            // 兼容新老设备 新版 openid   老版 openId\n            local.setItem('openid', openid)\n            local.setItem('openId', openid)\n\n            //}\n        }\n\n    }\n\n    getUserInfo() {\n        var serf = this;\n        axios.post('/wechat/account/memberInfoByOpenid', {openid: local.getItem('openid')}).then(function (data) {\n            //存储用户信息\n            const userData = data.data.data\n            // self.userId = userData.vipUsersId;\n            // self.phoneNum = userData.phoneNumber;\n\n            serf.setLocalUser(userData);\n\n            // if(Object.prototype.toString.call(cb)=== '[object Function]'){\n            //     cb(data);\n            // }\n\n            //微信config\n            weChatConfig();\n        }).catch((error)=>{\n            console.log('获取用户信息：'+error)\n        })\n\n\n    }\n\n    // 存储用户基本信息\n    setLocalUser(data) {\n        local.setItem('loginName', data.phoneNumber);//用户手机号\n        local.setItem('userType', data.userType);// 用户类型  0 成员   1  普通会员；\n        local.setItem('userId', data.vipUsersId);// 用户id\n        local.setItem('strNickName', data.vipUsersName);// 用户名\n        local.setItem('headPortrait', data.headPortrait);//用户头像\n    }\n\n\n}\n\nexport default new AppState()"]}